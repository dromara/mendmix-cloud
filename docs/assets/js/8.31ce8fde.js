(window.webpackJsonp=window.webpackJsonp||[]).push([[8],{818:function(t,s,a){"use strict";a.r(s);var e=a(111),r=Object(e.a)({},(function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[a("h1",{attrs:{id:"介绍"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#介绍"}},[t._v("#")]),t._v(" 介绍")]),t._v(" "),a("p",[t._v("Jeesuite-passport是面向企业级单点登录、统一认证的一站式解决方案。支持微信、企业微信、主流开放平台OAuth、Oauth2.0，JWT、SAML2.0多种集成模式。")]),t._v(" "),a("h2",{attrs:{id:"主要功能清单"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#主要功能清单"}},[t._v("#")]),t._v(" 主要功能清单")]),t._v(" "),a("ol",[a("li",[t._v("SSO单点登录、无域名限制")]),t._v(" "),a("li",[t._v("除了账号密码外还支持微信、企业微信、主流开放平台OAuth、Oauth2.0等多种登录方式")]),t._v(" "),a("li",[t._v("支持多个微信公众号及微信小程序模式")]),t._v(" "),a("li",[t._v("支持SDK,JWT、SAML2.0多种集成模式")]),t._v(" "),a("li",[t._v("支持单机与集群部署模式")])]),t._v(" "),a("h2",{attrs:{id:"特点"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#特点"}},[t._v("#")]),t._v(" 特点")]),t._v(" "),a("ul",[a("li",[t._v("轻量级：不依赖Shiro、Spring Secrity以及任何第三方认证框架")]),t._v(" "),a("li",[t._v("代码简单：二开成本低，可定制性高")])]),t._v(" "),a("h1",{attrs:{id:"服务端部署"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#服务端部署"}},[t._v("#")]),t._v(" 服务端部署")]),t._v(" "),a("h2",{attrs:{id:"下载项目"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#下载项目"}},[t._v("#")]),t._v(" 下载项目")]),t._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v("git clone https://gitee.com/vakinge/jeesuite-passport.git\n")])])]),a("h2",{attrs:{id:"编译及运行项目-包括前端和后端"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#编译及运行项目-包括前端和后端"}},[t._v("#")]),t._v(" 编译及运行项目（包括前端和后端）")]),t._v(" "),a("h3",{attrs:{id:"后端"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#后端"}},[t._v("#")]),t._v(" 后端")]),t._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v("mvn clean package -DskipTests=true\n")])])]),a("p",[a("strong",[t._v("最终生成部署包为")]),t._v("：jeesuite-passport-server/target/jeesuite-passport-server.jar")]),t._v(" "),a("h4",{attrs:{id:"创建数据库表"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#创建数据库表"}},[t._v("#")]),t._v(" 创建数据库表")]),t._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v("CREATE DATABASE IF NOT EXISTS `passport` DEFAULT CHARSET utf8 COLLATE utf8_general_ci;\n")])])]),a("h4",{attrs:{id:"数据库初始化"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#数据库初始化"}},[t._v("#")]),t._v(" 数据库初始化")]),t._v(" "),a("p",[t._v("执行docs目录下数据库脚本: init.sql 与 testdata.sql (此为测试数据，可选)")]),t._v(" "),a("h4",{attrs:{id:"修改配置文件"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#修改配置文件"}},[t._v("#")]),t._v(" 修改配置文件")]),t._v(" "),a("p",[t._v("修改"),a("code",[t._v("application-local.properties")]),t._v("配置内容")]),t._v(" "),a("h4",{attrs:{id:"启动"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#启动"}},[t._v("#")]),t._v(" 启动")]),t._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v("java -jar jeesuite-passport-server.jar\n# 或 （适合linux或mac 后台运行）\nnohup java -jar jeesuite-passport-server.jar > passport-server.out 2>&1 &\n")])])]),a("h3",{attrs:{id:"前端"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#前端"}},[t._v("#")]),t._v(" 前端")]),t._v(" "),a("p",[t._v("切换到目录"),a("code",[t._v("jeesuite-passport-web")]),t._v(",执行命令：")]),t._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[t._v("yarn")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("install")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("yarn")]),t._v(" build:prod\n")])])]),a("p",[a("strong",[t._v("最终生成部署文件在目录")]),t._v("：jeesuite-passport-web/dist下。")]),t._v(" "),a("h3",{attrs:{id:"添加本地host-域名可自定义"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#添加本地host-域名可自定义"}},[t._v("#")]),t._v(" 添加本地host (域名可自定义)")]),t._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v("127.0.0.1 passport.jeesuite.com\n")])])]),a("h3",{attrs:{id:"配置nginx"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#配置nginx"}},[t._v("#")]),t._v(" 配置Nginx")]),t._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v("server {\n        listen       80;\n        server_name  passport.jeesuite.com;\n\n        charset utf-8;\n        location / {\n          root /{这里是你的实际项目根目录}/jeesuite-passport/jeesuite-passport-web/dist ;\n          index index.html;\n        }\n        location /auth {\n          proxy_pass http://127.0.0.1:8080/auth;\n          proxy_set_header Host $host;\n          proxy_set_header X-Real-IP $remote_addr;\n          proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;\n        }\n}\n")])])]),a("h3",{attrs:{id:"启动nginx-查看效果"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#启动nginx-查看效果"}},[t._v("#")]),t._v(" 启动Nginx，查看效果")]),t._v(" "),a("p",[t._v("启动成功可以通过"),a("code",[t._v("passport.jeesuite.com")]),t._v("查看。")]),t._v(" "),a("hr"),t._v(" "),a("h1",{attrs:{id:"应用集成-客户端"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#应用集成-客户端"}},[t._v("#")]),t._v(" 应用集成（客户端）")]),t._v(" "),a("h2",{attrs:{id:"添加依赖"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#添加依赖"}},[t._v("#")]),t._v(" 添加依赖")]),t._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v("<dependency>\n  <groupId>com.jeesuite</groupId>\n  <artifactId>jeesuite-config-client</artifactId>\n <version>[版本号]</version>\n</dependency>\n")])])]),a("p",[t._v("查看版本号请进入"),a("a",{attrs:{href:"https://repo1.maven.org/maven2/com/jeesuite/jeesuite-passport-client/",target:"_blank",rel:"noopener noreferrer"}},[t._v("客户端maven 仓库"),a("OutboundLink")],1),t._v("查看")]),t._v(" "),a("h2",{attrs:{id:"添加配置"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#添加配置"}},[t._v("#")]),t._v(" 添加配置")]),t._v(" "),a("p",[t._v("在项目增加如下配置：")]),t._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v("jeesuite.passport.baseUrl=http://passport.jeesuite.com\njeesuite.passport.clientId=\njeesuite.passport.clientSecret=\n#不需要认证的URI多个;隔开\njeesuite.passport.anonymousUris=/abc/*;/status;/bar/foo\n")])])]),a("h2",{attrs:{id:"注册过滤器"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#注册过滤器"}},[t._v("#")]),t._v(" 注册过滤器")]),t._v(" "),a("div",{staticClass:"language-java extra-class"},[a("pre",{pre:!0,attrs:{class:"language-java"}},[a("code",[a("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[t._v("@Bean")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("public")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("FilterRegistrationBean")]),a("span",{pre:!0,attrs:{class:"token generics"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("SSOGlobalFilter")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("ssoFilterRegistration")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n\t"),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("FilterRegistrationBean")]),a("span",{pre:!0,attrs:{class:"token generics"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("SSOGlobalFilter")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v(" registration "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("FilterRegistrationBean")]),a("span",{pre:!0,attrs:{class:"token generics"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\tregistration"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("setFilter")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("SSOGlobalFilter")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\tregistration"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("addUrlPatterns")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"/*"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\tregistration"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("setName")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"authFilter"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\tregistration"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("setOrder")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\t"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" registration"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),a("p",[t._v("非springboot项目，在web.xml配置。")]),t._v(" "),a("h2",{attrs:{id:"登入登出入口"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#登入登出入口"}},[t._v("#")]),t._v(" 登入登出入口")]),t._v(" "),a("ul",[a("li",[t._v("登录：/sso/login")]),t._v(" "),a("li",[t._v("登出：/sso/logout")])]),t._v(" "),a("h2",{attrs:{id:"自定义session存储"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#自定义session存储"}},[t._v("#")]),t._v(" 自定义session存储")]),t._v(" "),a("p",[t._v("默认使用本地session，不支持集群方式共享session。如果需要支持集群共享session，需要实现"),a("code",[t._v("SessionStorageProvider")]),t._v("接口，并通过以下方式注册：")]),t._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v("PassportConfigHolder.setSessionStorageProvider(provider);\n")])])])])}),[],!1,null,null,null);s.default=r.exports}}]);